const idContenedorpanelesPestanias = "#paneles-pestanias";
const contenidoDinamico = [
    {
        "boton": "Interface Gráfica Web",
        "panel": {
            "id": "curso-igw",
            "nombre": "Interface Gráfica Web",
            "dia": "martes",
            "turno": "noche",
            "profesor": "Jorge Sánchez",
            "imagen": "img-igw.png",
            "calificaciones": "https://aulasvirtuales.bue.edu.ar/grade/report/user/index.php?id=23842",
            "trabajos": [
                {
                    "id": "tp1igw",
                    "nombre": "TP Nro. 1 HTML",
                    "diaEntrega": "2025-09-23",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867809/mod_assign/introattachment/0/Trabajo%20Practico%20Nro%201.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764274",
                    "estado": "pendiente"
                },
                {
                    "id": "tp2igw",
                    "nombre": "TP Nro. 2 CSS",
                    "diaEntrega": "2025-10-01",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867811/mod_assign/introattachment/0/Trabajo%20Practico%20Nro%202.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764276",
                    "estado": "entregado"
                },
                {
                    "id": "tp3igw",
                    "nombre": "TP Nro. 3 Maquetación",
                    "diaEntrega": "2025-10-14",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867813/mod_assign/introattachment/0/Trabajo%20Practico%20Nro%203.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764278",
                    "estado": "entregado"
                },
                {
                    "id": "tp4igw",
                    "nombre": "TP Nro. 4 Bootstrap",
                    "diaEntrega": "2025-10-21",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867815/mod_assign/introattachment/0/Trabajo%20Practico%20Nro%204.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764278",
                    "estado": "entregado"
                },
                {
                    "id": "tp5igw",
                    "nombre": "TP Nro. 5 Manejo de Eventos",
                    "diaEntrega": "2025-10-28",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867817/mod_assign/introattachment/0/TP%20Nro%205%20Javascript%20Manejo%20de%20Eventos.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764282",
                    "estado": "entregado"
                },
                {
                    "id": "tp6igw",
                    "nombre": "TP Nro. 6 Gestión de APIs mediante JavaScript",
                    "diaEntrega": "2025-11-04",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2879323/mod_assign/introattachment/0/Trabajo%20Practico%20Nro%206.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=771727",
                    "estado": "pendiente"
                },
                {
                    "id": "tp7igw",
                    "nombre": "TP Nro. 7 Gestión de APIs mediante Axios",
                    "diaEntrega": "2025-11-11",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2882583/mod_assign/introattachment/0/Trabajo%20Pr%C3%A1ctico%20Nro%207.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=774618",
                    "estado": "pendiente"
                }
            ]
        }
    },
    {
        "boton": "Desarrollo de Aplicaciones Web",
        "panel": {
            "id": "curso-daw",
            "nombre": "Desarrollo de Aplicaciones Web",
            "dia": "miércoles",
            "turno": "noche",
            "profesor": "Jorge Sánchez",
            "imagen": "img-daw.png",
            "calificaciones": "https://aulasvirtuales.bue.edu.ar/grade/report/user/index.php?id=23843",
            "trabajos": [
                {
                    "id": "tp1daw",
                    "nombre": "TP Nro. 1 API Springboot",
                    "diaEntrega": "2025-10-08",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2868317/mod_assign/introattachment/0/TP%20N1%20APIs%20con%20SpringBoot.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764624",
                    "estado": "pendiente"
                },
                {
                    "id": "tp2daw",
                    "nombre": "TP N2 JPA Hibernate",
                    "diaEntrega": "2025-10-23",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2876374/mod_assign/introattachment/0/Trabajo%20Pr%C3%A1ctico%20Nro2%20JPA%20Hibernate.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=769192",
                    "estado": "pendiente"
                },
                {
                    "id": "tp3daw",
                    "nombre": "TP Nro.3 DTO - Query Method",
                    "diaEntrega": "2025-11-05",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2880046/mod_assign/introattachment/0/Trabajo%20Pr%C3%A1ctico%20Nro3%20DTO-Method%20query.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=772390",
                    "estado": "pendiente"
                }
            ]
        }
    },
    {
        "boton": "Gestión de Base de Datos",
        "panel": {
            "id": "curso-gbd",
            "nombre": "Gestión de Base de Datos",
            "dia": "jueves",
            "turno": "noche",
            "profesor": "Jorge Sánchez",
            "imagen": "img-gbd.png",
            "calificaciones": "https://aulasvirtuales.bue.edu.ar/grade/report/user/index.php?id=23841",
            "trabajos": [
                {
                    "id": "tp1gbd",
                    "nombre": "Trabajo Practico Diseño de BD",
                    "diaEntrega": "2025-10-02",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867776/mod_assign/introattachment/0/Trabajo%20Practico%20Dise%C3%B1o%20de%20Base%20de%20Datos.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764242",
                    "estado": "pendiente"
                },
                {
                    "id": "tp2gbd",
                    "nombre": "Trabajo Practico Integridad Referencial",
                    "diaEntrega": "2025-10-02",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867778/mod_assign/introattachment/0/Trabajo%20Practico%20Integridad%20Referencial.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764244",
                    "estado": "pendiente"
                },
                {
                    "id": "tp3gbd",
                    "nombre": "Trabajo Practico Indices",
                    "diaEntrega": "2025-10-16",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867782/mod_assign/introattachment/0/Trabajo%20Practico%20sobre%20%C3%ADndices.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764248",
                    "estado": "pendiente"
                },
                {
                    "id": "tp4gbd",
                    "nombre": "Trabajo Practico Vistas",
                    "diaEntrega": "2025-10-13",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867780/mod_assign/introattachment/0/Ejercitaci%C3%B3n%20sobre%20Vistas.docx.pdf?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764246",
                    "estado": "pendiente"
                },
                {
                    "id": "tp5gbd",
                    "nombre": "Trabajo Práctico sobre Funciones de Usuario",
                    "diaEntrega": "2025-11-06",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867784/mod_assign/introattachment/0/Trabajo%20Pr%C3%A1ctico%20sobre%20Funciones%20de%20Usuario.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764250",
                    "estado": "pendiente"
                },
                {
                    "id": "tp6gbd",
                    "nombre": "Trabajo Práctico sobre Procedimientos Almacenados",
                    "diaEntrega": "2025-10-30",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867786/mod_assign/introattachment/0/Trabajo%20Pr%C3%A1ctico%20sobre%20Procedimientos%20Almacenados.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764252",
                    "estado": "pendiente"
                },
                {
                    "id": "tp7gbd",
                    "nombre": "Trabajo Practico Triggers",
                    "diaEntrega": "2025-10-23",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867788/mod_assign/introattachment/0/Trabajo%20Practico%20triggers.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764254",
                    "estado": "pendiente"
                },
                {
                    "id": "tp8gbd",
                    "nombre": "Trabajo Practico sobre Transacciones",
                    "diaEntrega": "2025-11-13",
                    "horaEntrega": "23:59",
                    "consigna": "https://aulasvirtuales.bue.edu.ar/pluginfile.php/2867790/mod_assign/introattachment/0/Trabajo%20Practico%20sobre%20Transacciones%20en%20MySQL.docx?forcedownload=1",
                    "urlEntrega": "https://aulasvirtuales.bue.edu.ar/mod/assign/view.php?id=764256",
                    "estado": "pendiente"
                }
            ]
        }
    }
];

// Genero los elementos contenedores de la estructura de pestañas y paneles y aplico estilos
const botonesNavegacion = $("<ul>");
const panelesContenido = $("<div>");

// estilos
botonesNavegacion.addClass("nav nav-pills");
panelesContenido.addClass("tab-content");

// Contenido de botones y paneles
// agrego botones
botonesNavegacion.append(
    contenidoDinamico.map((reg, i) => {
        const htmlListaBotones = `
            <li class="nav-item">
                <a class="nav-link ${i === 0 ? "active" : ""}" data-bs-toggle="pill" href="#${reg.panel.id}">${reg.boton}</a>
            </li>`;
        
            return htmlListaBotones;
    }).join("")
);
// agrego contenido de paneles
// panelesContenido.append(
//     contenidoDinamico.map((reg, i) => {
//         // Dados del curso y etiquetas de datos
//         const cntTPs = reg.panel.trabajos.length;
//         const cntTPsEntregados = reg.panel.trabajos.filter(t => t.estado === "entregado").length;
//         const cntTPsPendientes = reg.panel.trabajos.filter(t => t.estado === "pendiente").length;
//         const etqTPsEntregados = `<span class="badge bg-success">${cntTPsEntregados} ${cntTPsEntregados === 1 ? "entregado" : "entregados"}</span>`;
//         const etqTPsPendientes = `<span class="badge bg-info">${cntTPsPendientes} ${cntTPsPendientes === 1 ? "pendiente" : "pendientes"}</span>`;
//         const htmlDatosCurso = `
//             <div class="row mx-1 pt-2 bg-info-subtle roundes-3 shadow-lg">
//                 <div class="col-sm-2">
//                     <img src="img/${reg.panel.imagen}" alt="Imagen del curso ${reg.panel.nombre}" class="img-fluid rounded-3 mb-2" />
//                 </div>
//                 <div class="col-sm-10 align-items-sm-center pb-2">
//                     <h3 class="w-100 bg-info text-center rounded-2">${reg.panel.nombre}</h3>
//                     <strong>Día:</strong> ${reg.panel.dia}<br />
//                     <strong>Turno:</strong> ${reg.panel.turno}<br />
//                     <strong>Profesor:</strong> ${reg.panel.profesor}<br />
//                     <strong>Total de trabajos prácticos:</strong> ${cntTPs} ${cntTPsEntregados > 0 ? etqTPsEntregados : ""} ${cntTPsPendientes > 0 ? etqTPsPendientes : ""}
//                 </div>
//             </div>`;
        
//         // Detalle de trabajos prácticos y fechas de trentrega
//         const htmlDetalleTPs = reg.panel.trabajos.map(tp => {
//             // Cálculos de fechas y días de TPs
//             const fechaActual = new Date();
//             const fechaEntrega = new Date(tp.diaEntrega + " " + tp.horaEntrega);
//             const diasHastaEntrega = Math.round((fechaEntrega.getTime() - fechaActual.getTime()) / (1000 * 60 * 60 * 24));
//             const tpVenceHoy = diasHastaEntrega === 0;

//             // Generación de estilos según fechas de TPs
//             const fechaEntregaFormateada = fechaEntrega.toLocaleString("es-AR", {dateStyle: "full"}) + " " + tp.horaEntrega + "h";
//             const etqFechaEntregaTP = `<span class="text-secondary">${fechaEntregaFormateada}</span>`;
//             const etqFechaTPCerrada = `<span class="badge bg-secondary">Entrega cerrada</span>`;
//             const etqFechaTPCierraHoy = `<span class="badge bg-danger">Cierra hoy</span>`;

//             // Datos de TP
//             const htmlTP = `
//                 <strong>${tp.nombre}</strong><br />
//                 <strong>Fecha de entrega:</strong> ${etqFechaEntregaTP} ${diasHastaEntrega < 0 ? etqFechaTPCerrada : tpVenceHoy ? etqFechaTPCierraHoy : ""}<br />
//                 <a href="${tp.consigna}" class="link-underline link-underline-opacity-0" target="_blank" title="Click para abrir el archivo de consinga en el Aula Virtual">
//                     Enlace a la consigna
//                 </a>
//                 <br />
//                 <a href="${tp.urlEntrega}" class="link-underline link-underline-opacity-0" target="_blank" title="Click para abrir la sección de entrega del TP en el Aula Virtual">
//                     Enlace de entrega
//                 </a>
//                 <br />
//                 <div class="form-check form-switch form-check-inline pt-1">
//                     <input class="form-check-input estado-tp-checkbox" type="checkbox" id="check-${tp.id}" data-tpid="${tp.id}" ${tp.estado === "entregado" ? "checked" : ""} />
//                     <label class="form-check-label" for="check-${tp.id}">Trabajo entregado</label>
//                 </div>`;

//             return htmlTP;

//         }).join("");

//         const htmlListadoTPs = `
//             <div class="row mt-5 px-3">
//                 <p class="h4 mt-2 p-0">
//                     <span class="badge bg-success w-100 py-2">Trabajos prácticos</span>
//                 </p>
//                 ${htmlDetalleTPs}
//             </div>
//         `;

//         const htmlContenidoPanel = `
//             <div class="tab-pane container fade ${i === 0 ? "active show" : ""}" id="${reg.panel.id}" role="tabpanel">
//                 <div class="border border-1 border-info bg-light p-3 rounded-3 mt-1">
//                     ${htmlDatosCurso}
//                     ${htmlListadoTPs}
//                 </div>
//             </div>`;

//         return htmlContenidoPanel;
//     }).join("")
// );

panelesContenido
    .append(
        contenidoDinamico.map((reg, i) => {
            // Dados del curso y etiquetas de datos
            const cntTPs = reg.panel.trabajos.length;
            const cntTPsEntregados = reg.panel.trabajos.filter(t => t.estado === "entregado").length;
            const cntTPsPendientes = reg.panel.trabajos.filter(t => t.estado === "pendiente").length;
            const etqTPsEntregados = `<span class="badge bg-success">${cntTPsEntregados} ${cntTPsEntregados === 1 ? "entregado" : "entregados"}</span>`;
            const etqTPsPendientes = `<span class="badge bg-warning">${cntTPsPendientes} ${cntTPsPendientes === 1 ? "pendiente" : "pendientes"}</span>`;
            const htmlEncabezadoDatosCurso = `
                <div class="row mx-1 pt-2 bg-info-subtle roundes-3 shadow-lg">
                    <div class="col-sm-2">
                        <img src="img/${reg.panel.imagen}" alt="Imagen del curso ${reg.panel.nombre}" class="img-fluid rounded-3 mb-2" />
                    </div>
                    <div class="col-sm-10 align-items-sm-center pb-2">
                        <h3 class="w-100 bg-info text-center rounded-2">${reg.panel.nombre}</h3>
                        <strong>Día:</strong> ${reg.panel.dia}<br />
                        <strong>Turno:</strong> ${reg.panel.turno}<br />
                        <strong>Profesor:</strong> ${reg.panel.profesor}<br />
                        <strong>Total de trabajos prácticos:</strong> ${cntTPs} ${cntTPsEntregados > 0 ? etqTPsEntregados : ""} ${etqTPsPendientes}
                    </div>
                </div>`;

            // Cálculos de estilos según fechas de cierre
            const htmlListadoTPs = reg.panel.trabajos.map(tp => {
                // Cálculos de fechas y días de TPs
                const fechaActual = new Date();
                const fechaEntrega = new Date(tp.diaEntrega + " " + tp.horaEntrega);
                const diasHastaEntrega = Math.round((fechaEntrega.getTime() - fechaActual.getTime()) / (1000 * 60 * 60 * 24));
                const tpVencido = diasHastaEntrega < 0;
                const tpVenceHoy = diasHastaEntrega === 0;
                const tpVenceManiana = diasHastaEntrega === 1;
                const tpVenceEstaSemana = diasHastaEntrega > 1 && diasHastaEntrega < 6;

                // Generación de estilos según fechas de TPs
                const fechaEntregaFormateada = fechaEntrega.toLocaleString("es-AR", {dateStyle: "full"}) + " " + tp.horaEntrega + " h";
                const etqFechaEntregaTP = `<span class="text-secondary">${fechaEntregaFormateada}</span>`;
                const etqFechaTPCerrada = `<span class="badge bg-secondary">Entrega cerrada</span>`;
                const etqFechaTPCierraHoy = `<span class="badge bg-danger">Cierra hoy</span>`;
                const etqDiasHastaEntrega = `<span class="badge bg-dark">${diasHastaEntrega} días </span>`;
                const fondoArticulo = 
                    tpVencido ? "border-secondary bg-secondary-subtle position-relative" :      // El TP tiene fecha cerrada, el fondo es secondary (gris)
                    tpVenceHoy ? "border-danger bg-danger-subtle position-relative" :           // El TP cierra hoy, el fondo es danger (rojo)
                    tpVenceEstaSemana ? "border-danger bg-warning-subtle position-relative" :   //  El TP cierra en la semana, el fondo es naranja (warning)
                    "border-success bg-success-subtle position-relative";                       // El TP tiene timpo de entrega vigente, el fondo es success (verde)

                // Datos de TP
                const htmlTP = `
                    <div class="border-start border-3 rounded-3 p-2 my-2 ${fondoArticulo}">
                        ${tpVenceHoy ? `<span class="badge bg-danger etiqueta-esquina-superior-derecha">Vence hoy</span>` : ""}
                        ${tpVenceManiana ? `<span class="badge bg-danger etiqueta-esquina-superior-derecha">Vence mañana</span>` : ""}
                        ${tpVenceEstaSemana ? `<span class="badge bg-warning etiqueta-esquina-superior-derecha">Vence esta semana</span>` : ""}
                        <strong>${tp.nombre}</strong><br />
                        <strong>Fecha de entrega:</strong> ${etqFechaEntregaTP} ${diasHastaEntrega < 0 ? etqFechaTPCerrada : tpVenceHoy ? etqFechaTPCierraHoy : ""} ${diasHastaEntrega > 0 ? etqDiasHastaEntrega : ""}<br />
                        <a href="${tp.consigna}" class="link-underline link-underline-opacity-0" target="_blank" title="Click para abrir el archivo de consinga en el Aula Virtual">
                            Enlace a la consigna
                        </a>
                        <br />
                        <a href="${tp.urlEntrega}" class="link-underline link-underline-opacity-0" target="_blank" title="Click para abrir la sección de entrega del TP en el Aula Virtual">
                            Enlace de entrega
                        </a>
                        <br />
                        <div class="form-check form-switch form-check-inline pt-1">
                            <input class="form-check-input estado-tp-checkbox" type="checkbox" id="check-${tp.id}" data-tpid="${tp.id}" ${tp.estado === "entregado" ? "checked" : ""} />
                            <label class="form-check-label" for="check-${tp.id}">Trabajo entregado</label>
                        </div>
                    </div>`;

                return htmlTP;

            }).join("");

            const htmlDetalleTPs = `
                <div class="row mt-5 px-3">
                    <p class="h4 mt-2 p-0">
                        <span class="badge bg-success w-100 py-2">Trabajos prácticos</span>
                    </p>
                    ${htmlListadoTPs}
                </div>`;

            const htmlPanel = `
                <div class="tab-pane container fade ${i === 0 ? "active show" : ""}" id="${reg.panel.id}" role="tabpanel">
                    <div class="border border-1 border-info bg-light p-3 rounded-3 mt-1">
                        ${htmlEncabezadoDatosCurso}
                        ${htmlDetalleTPs}
                    </div>
                </div>`;

            return htmlPanel;
        }).join("")
    );

// Insterto los bloques HTML en el contenedor especificado por ID
$(idContenedorpanelesPestanias)
    .append(botonesNavegacion)
    .append(panelesContenido);